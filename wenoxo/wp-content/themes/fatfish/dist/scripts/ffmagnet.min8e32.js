class FFMagnet{static utils={get_mouse_pos:e=>({x:typeof e!=="undefined"?e.clientX:0,y:typeof e!=="undefined"?e.clientY:0}),get_scroll_left:()=>window.scrollX,get_scroll_top:()=>window.scrollY,point_is_within_bounds:(e,t)=>e.x>=t.left&&e.x<=t.left+t.width&&e.y>=t.top&&e.y<=t.top+t.height,lerp:(e,t,s)=>(1-s)*e+s*t,has_barba_library:()=>typeof barba==="object"&&typeof barba.hooks!=="undefined"};static default_options={lerp_amount:.1,trigger_distance:60,movement_factor:.4,sub_elements:[],disabled:false};static accepted_options=Object.keys(FFMagnet.default_options);static options_presets={};static mouse_pos=FFMagnet.utils.get_mouse_pos();static instances=[];static dependencies={gsap:"FFMagnet: La bibiliothÃ¨que GSAP est manquante. Elle est disponible au https://cdnjs.com/libraries/gsap."};static has_pointer_device=!window.matchMedia("(any-hover: none)").matches;constructor(e,t={}){if(!FFMagnet.has_pointer_device){return}this.element=typeof e==="string"?document.querySelector(e):e;if(!this.element){console.warn(`FFMagnet: L'Ã©lÃ©ment${typeof e==="string"?` "${e}"`:""} n'a pu Ãªtre trouvÃ© dans la page et donc l'instance n'a pu Ãªtre instanciÃ©.`);return}if(typeof this.element.ffmagnet_instance!=="undefined"&&this.element.ffmagnet_instance instanceof FFMagnet){return}this.options={...FFMagnet.default_options,...t};this.options=FFMagnet.filter_invalid_options(this.options);this.element_bounds={};this.dependency_is_missing=false;this.classes={main:"ff-magnet",active:"ff-magnet--active",disabled:"ff-magnet--disabled"};this.states={active:false,disabled:this.options.disabled,destroyed:false};this.event_handlers={resize:null};this.options={...this.options,lerp_amount:gsap.utils.clamp(0,1,this.options.lerp_amount),trigger_distance:Math.max(0,this.options.trigger_distance)};this.check_dependencies();if(this.dependency_is_missing){return}FFMagnet.instances.push(this);this.setup()}setup(){this.refresh();this.add_event_listeners();if(!this.element.classList.contains(this.classes.main)){this.element.classList.add(this.classes.main)}this.element.ffmagnet_instance=this;this.set_sub_elements();const s=gsap.quickSetter(this.element,"x","px");const n=gsap.quickSetter(this.element,"y","px");this.set_element_pos=(e,t)=>{s(e);n(t)};this.sub_elements_pos_setters=this.sub_elements.map(e=>{const s=gsap.quickSetter(e.element,"x","px");const n=gsap.quickSetter(e.element,"y","px");return(e,t)=>{s(e);n(t)}});this.ticker_handler=()=>this.render();gsap.ticker.add(this.ticker_handler)}set_sub_elements(){const e=typeof this.options.sub_elements==="string"?Array.from(this.element.querySelectorAll(this.options.sub_elements)):this.options.sub_elements;this.sub_elements=e.map(e=>{let t=typeof e==="object"&&typeof e.element!=="undefined"?e.element:e;t=typeof t==="string"?this.element.querySelector(t):t;t=t instanceof HTMLElement&&this.element.contains(t)?t:null;if(!t)return null;return{element:t,movement_factor:typeof e.movement_factor==="number"?e.movement_factor:.5,lerp_amount:gsap.utils.clamp(0,1,typeof e.lerp_amount==="number"?e.lerp_amount:this.options.lerp_amount)}}).filter(Boolean)}refresh(){gsap.set(this.element,{x:0,y:0});const e=this.element.getBoundingClientRect();this.element_bounds={left:e.left+FFMagnet.utils.get_scroll_left(),top:e.top+FFMagnet.utils.get_scroll_top(),width:e.width,height:e.height}}render(){const e=FFMagnet.mouse_pos;const t=FFMagnet.utils.get_scroll_left();const s=FFMagnet.utils.get_scroll_top();const n=FFMagnet.utils.point_is_within_bounds({x:e.x+t,y:e.y+s},{left:this.element_bounds.left-this.options.trigger_distance,top:this.element_bounds.top-this.options.trigger_distance,width:this.element_bounds.width+this.options.trigger_distance*2,height:this.element_bounds.height+this.options.trigger_distance*2});if(!this.states.disabled&&n&&!this.states.active){this.states.active=true;this.element.classList.add(this.classes.active)}else if(!n&&this.states.active){this.states.active=false;this.element.classList.remove(this.classes.active)}const i={x:gsap.getProperty(this.element,"x"),y:gsap.getProperty(this.element,"y")};let a={x:0,y:0};if(this.states.active){a={x:(e.x+t-(this.element_bounds.left+this.element_bounds.width/2))*this.options.movement_factor,y:(e.y+s-(this.element_bounds.top+this.element_bounds.height/2))*this.options.movement_factor}}let o=a;if(this.options.lerp_amount<1){o={x:parseFloat(FFMagnet.utils.lerp(i.x,a.x,this.options.lerp_amount).toFixed(3)),y:parseFloat(FFMagnet.utils.lerp(i.y,a.y,this.options.lerp_amount).toFixed(3))}}const l=this.sub_elements.map(e=>{const t=e.element;const s={x:gsap.getProperty(t,"x"),y:gsap.getProperty(t,"y")};const n={x:a.x*(e.movement_factor-1),y:a.y*(e.movement_factor-1)};return{x:parseFloat(FFMagnet.utils.lerp(s.x,n.x,e.lerp_amount).toFixed(3)),y:parseFloat(FFMagnet.utils.lerp(s.y,n.y,e.lerp_amount).toFixed(3))}});this.set_element_pos(o.x,o.y);this.sub_elements_pos_setters.forEach((e,t)=>{const s=l[t];if(s){e(s.x,s.y)}})}check_dependencies(){Object.entries(FFMagnet.dependencies).forEach(([e,t])=>{if(typeof window[e]!=="undefined")return;this.dependency_is_missing=true;console.error(t)})}add_event_listeners(){window.addEventListener("load",()=>this.refresh());let e;this.event_handlers.resize=()=>{clearTimeout(e);e=setTimeout(()=>{this.refresh();e=null},500)};window.addEventListener("resize",this.event_handlers.resize);if(FFMagnet.utils.has_barba_library()){barba.hooks.after(()=>{if(document.body.contains(this.element))return;this.destroy()})}}enable(){if(this.states.destroyed)return;this.states.disabled=false;this.element.classList.remove(this.classes.disabled)}disable(){if(this.states.destroyed)return;this.states.disabled=true;this.states.active=false;this.element.classList.add(this.classes.disabled);this.element.classList.remove(this.classes.active)}destroy(){if(this.states.destroyed)return;this.states.destroyed=true;gsap.ticker.remove(this.ticker_handler);window.removeEventListener("resize",this.event_handlers.resize);[this.element,...this.sub_elements.map(e=>e.element)].forEach(e=>{gsap.set(e,{clearProps:"x,y"})});this.element.classList.remove(...Object.values(this.classes));const e=FFMagnet.instances.indexOf(this);if(e!==-1){FFMagnet.instances.splice(e,1)}}static defaults(e){const t={...FFMagnet.default_options,...e};FFMagnet.default_options=FFMagnet.filter_invalid_options(t)}static add_options_presets(e){Object.entries(e).forEach(([e,t])=>{if(typeof t!=="object")return;t=FFMagnet.filter_invalid_options(t);if(Object.keys(t).length){FFMagnet.options_presets[e]=t}})}static filter_invalid_options(t){return Object.fromEntries(FFMagnet.accepted_options.filter(e=>typeof t[e]!=="undefined").map(e=>[e,t[e]]))}static scroll_left_proxy(e){if(typeof e!=="function"||typeof e()!=="number")return;FFMagnet.utils.get_scroll_left=e}static scroll_top_proxy(e){if(typeof e!=="function"||typeof e()!=="number")return;FFMagnet.utils.get_scroll_top=e}static get_all(){return this.instances}static get_by_element(t){t=typeof t==="string"?document.querySelector(t):t;return FFMagnet.get_all().find(e=>e.element===t)||null}static refresh_all(){FFMagnet.get_all().forEach(e=>e.refresh())}static update_instances(){FFMagnet.instances=FFMagnet.instances.filter(e=>document.body.contains(e.element));document.querySelectorAll("[data-ff-magnet]").forEach(t=>{if(FFMagnet.instances.some(e=>e.element===t))return;const e=t.getAttribute("data-ff-magnet-preset");const s=FFMagnet.options_presets[e];const n=s||{};new FFMagnet(t,n)})}}(()=>{if(!FFMagnet.has_pointer_device){return}window.addEventListener("mousemove",e=>{FFMagnet.mouse_pos=FFMagnet.utils.get_mouse_pos(e)});const e=()=>{FFMagnet.update_instances();setTimeout(()=>FFMagnet.refresh_all())};document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{e();if(FFMagnet.utils.has_barba_library()){barba.hooks.beforeEnter(e)}})});window.addEventListener("load",()=>{setTimeout(()=>FFMagnet.refresh_all())})})();