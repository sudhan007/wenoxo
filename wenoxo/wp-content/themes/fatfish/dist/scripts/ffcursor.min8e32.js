class FFCursor{elements=[];hover_states=[];click_states=[];event_handlers={};dependency_is_missing=false;is_disabled=false;static utils={get_mouse_pos:e=>({x:typeof e!=="undefined"?e.clientX:0,y:typeof e!=="undefined"?e.clientY:0}),lerp:(e,t,s)=>(1-s)*e+s*t,has_barba_library:()=>typeof barba==="object"&&typeof barba.hooks!=="undefined"};static default_options={keep_native_cursor:true,hover_states:[],click_states:[]};static elements_default_options={classes:"",attributes:"",lerp_amount:1,inner_html:"",on_update:()=>{},default_magnet_options:{force:.9,position:"center"}};static hover_states_default_options={active_class:"",triggers:"",magnet:false,remove_on_barba_leave:true,on_enter:()=>{},on_leave:()=>{}};static click_states_default_options={active_class:"",triggers:"",remove_on_barba_leave:true,on_enter:()=>{},on_leave:()=>{}};static accepted_options=Object.keys(FFCursor.default_options);static accepted_elements_options=Object.keys(FFCursor.elements_default_options);static accepted_hover_states_options=Object.keys(FFCursor.hover_states_default_options);static accepted_click_states_options=Object.keys(FFCursor.click_states_default_options);static mouse_pos=FFCursor.utils.get_mouse_pos();static has_mouse_down=false;static global_event_handlers={document_mousemove:null,document_mousedown:null,document_mouseup:null,document_mouseleave:null,document_mouseenter:null};static instances=[];static dependencies={gsap:"FFCursor: La bibiliothÃ¨que GSAP est manquante. Elle est disponible au https://cdnjs.com/libraries/gsap."};static has_pointer_device=!window.matchMedia("(any-hover: none)").matches;constructor(e,t={}){if(!FFCursor.has_pointer_device){this.is_disabled=true;return}this.check_dependencies();if(this.dependency_is_missing){this.is_disabled=true;return}if(!e||typeof e!=="object"){console.error('FFCursor: Il faut donner en premier paramÃ¨tre des objets reprÃ©sentant un ou des Ã©lÃ©ment(s) avec une ou plusieurs classes valides en string Ã  la propriÃ©tÃ© "classes.');this.is_disabled=true;return}this.options={...FFCursor.default_options,...t};this.options=FFCursor.filter_invalid_options(this.options);this.sub_elements_objects=e.map(e=>{if(!e.classes||typeof e.classes!=="string"&&!Array.isArray(e.classes)){return null}e=FFCursor.filter_invalid_options({...FFCursor.elements_default_options,...e},FFCursor.accepted_elements_options);return{...e,classes:(Array.isArray(e.classes)?e.classes:e.classes.split(" ")).filter(e=>typeof e==="string"&&e),set_pos:()=>{},active_magnet_element:null,active_magnet_options:null,on_update:typeof e.on_update==="function"?e.on_update:()=>{},default_magnet_options:this.parse_magnet_options(e.default_magnet_options),lerp_amount:gsap.utils.clamp(1e-4,1,e.lerp_amount)}}).filter(e=>e&&e.classes.length!==0);if(this.sub_elements_objects.length===0||e.length!=this.sub_elements_objects.length){console.error('FFCursor: Il faut donner, en premier paramÃ¨tre du constructor, un tableau d\'objets reprÃ©sentant un Ã©lÃ©ment avec une ou plusieurs classe(s) valides Ã  la propriÃ©tÃ© "classes".');this.is_disabled=true;return}this.hover_states=typeof t.hover_states==="object"?t.hover_states:[];this.hover_states=this.hover_states.map(e=>{if(!e.active_class||typeof e.active_class!=="string"||!e.triggers||typeof e.triggers!=="string"){return null}e=FFCursor.filter_invalid_options({...FFCursor.hover_states_default_options,...e},FFCursor.accepted_hover_states_options);return{...e,magnet:typeof e.magnet==="object"?this.parse_magnet_options(e.magnet):e.magnet,active:false,on_enter:typeof e.on_enter==="function"?e.on_enter:()=>{},on_leave:typeof e.on_leave==="function"?e.on_leave:()=>{}}}).filter(Boolean);this.click_states=typeof t.click_states==="object"?t.click_states:[];this.click_states=this.click_states.map(e=>{if(!e.active_class||typeof e.active_class!=="string"||!e.triggers||typeof e.triggers!=="string"){return null}e=FFCursor.filter_invalid_options({...FFCursor.click_states_default_options,...e},FFCursor.accepted_click_states_options);return{...e,active:false,on_enter:typeof e.on_enter==="function"?e.on_enter:()=>{},on_leave:typeof e.on_leave==="function"?e.on_leave:()=>{}}}).filter(Boolean);FFCursor.instances.push(this);this.setup();document.documentElement.classList.add("has-ffcursor");setTimeout(()=>{if(FFCursor.mouse_pos.x>=0&&FFCursor.mouse_pos.y>=0){this.elements.container.classList.remove("ffcursor--out-of-page")}})}check_dependencies(){Object.entries(FFCursor.dependencies).forEach(([e,t])=>{if(typeof window[e]!=="undefined")return;this.dependency_is_missing=true;console.error(t)})}setup(){if(!this.options.keep_native_cursor){document.documentElement.classList.add("has-non-native-ffcursor")}this.setup_html();this.add_event_listeners();this.setup_cursor_updater()}setup_html(){this.elements.container=document.createElement("div");this.elements.container.classList.add("ffcursor");document.body.appendChild(this.elements.container);this.elements.sub_elements=[];this.sub_elements_objects.forEach((e,t)=>{const s=document.createElement("div");s.classList.add("ffcursor__sub-element",...e.classes);s.innerHTML=e.inner_html;this.elements.container.appendChild(s);this.elements.sub_elements.push(s);if(e.attributes&&typeof e.attributes==="string"){e.attributes.split(" ").map(e=>{const t=e.split("=")[0];const s=typeof e.split("=")[1]==="undefined"?"":e.split("=")[1].replaceAll('"',"").replaceAll("'","");return t=="class"?null:{attribute:t,value:s}}).filter(Boolean).forEach(e=>{s.setAttribute(e.attribute,e.value)})}})}add_event_listeners(){const o=(t,s=null)=>{this.sub_elements_objects.forEach(e=>{if(!e.default_magnet_options)return;e.active_magnet_element=t;e.active_magnet_options=s||e.default_magnet_options})};const n=t=>{this.sub_elements_objects.forEach(e=>{if(!e.active_magnet_element||!e.default_magnet_options||t&&!e.active_magnet_element.matches(t))return;e.active_magnet_element=null;e.active_magnet_options=null})};this.hover_states.forEach(s=>{s.mouseenter_handler=e=>{e.stopPropagation();if(s.active||!e.target.matches(s.triggers))return;if(s.magnet){const t=typeof s.magnet==="object"?s.magnet:null;o(e.target,t)}this.elements.container.classList.add(s.active_class);s.on_enter({self:this,event:e,trigger:e.target});s.active=true};document.body.addEventListener("mouseenter",s.mouseenter_handler,{capture:true});s.mouseleave_handler=e=>{if(!s.active||!e.target.matches(s.triggers))return;if(s.magnet){n()}this.elements.container.classList.remove(s.active_class);s.on_leave({self:this,event:e,trigger:e.target});s.active=false};document.body.addEventListener("mouseleave",s.mouseleave_handler,{capture:true})});this.click_states.forEach(t=>{let s=null;t.mousedown_handler=e=>{if(t.active)return;s=e.path.find(e=>e.matches&&e.matches(t.triggers))||null;if(!s)return;if(t.magnet){o(s)}this.elements.container.classList.add(t.active_class);t.on_enter({self:this,event:e,trigger:s});t.active=true};document.body.addEventListener("mousedown",t.mousedown_handler,{capture:true});t.mouseup_handler=e=>{if(!t.active)return;if(t.magnet){n(t.triggers)}this.elements.container.classList.remove(t.active_class);t.on_leave({self:this,event:e,trigger:s});t.active=false;s=null};document.body.addEventListener("mouseup",t.mouseup_handler,{capture:true})});if(FFCursor.utils.has_barba_library()){let a;let t;barba.hooks.before(()=>{t=document.elementFromPoint(FFCursor.mouse_pos.x,FFCursor.mouse_pos.y)},"FFCursor");let e=Array.from(barba.hooks.registered.get("before")).sort((e,t)=>e.ctx==="FFCursor"?-1:1);e=new Set(e);barba.hooks.registered.set("before",e);barba.hooks.leave(({current:s})=>{const o=this.hover_states.filter(e=>e.remove_on_barba_leave).map(e=>t.matches(e.triggers)?t:t.closest(e.triggers)).filter(Boolean);const n=this.click_states.filter(e=>e.remove_on_barba_leave&&FFCursor.has_mouse_down).map(e=>t.matches(e.triggers)?t:t.closest(e.triggers)).filter(Boolean);const r=(e,t)=>{const s=new MouseEvent(t);Object.defineProperty(s,"target",{writable:false,value:e});document.body.dispatchEvent(s)};o.forEach(e=>{r(e,"mouseleave")});n.forEach(e=>{r(e,"mouseup")});a=new MutationObserver(e=>{e.forEach(e=>{const t=Array.from(e.removedNodes);if(!t.includes(s.container))return;o.forEach(e=>r(e,"mouseleave"));n.forEach(e=>r(e,"mouseup"));a.disconnect()})});a.observe(document.body,{childList:true,subtree:true})});barba.hooks.after(()=>a&&a.disconnect())}}setup_cursor_updater(){this.sub_elements_objects.forEach((e,t)=>{const s=this.elements.sub_elements[t];const o=gsap.quickSetter(s,"x","px");const n=gsap.quickSetter(s,"y","px");e.set_pos=(e,t)=>{o(e);n(t)}});this.last_tick_t=Date.now();this.event_handlers.ticker=()=>{this.update_elements();this.last_tick_t=Date.now()};gsap.ticker.add(this.event_handlers.ticker)}update_elements(){if(this.is_disabled)return;this.sub_elements_objects.forEach((s,e)=>{const t=this.elements.sub_elements[e];const o={width:t.offsetWidth,height:t.offsetHeight};let n;let r;const a=gsap.getProperty(t,"x");const i=gsap.getProperty(t,"y");if(s.active_magnet_element&&s.active_magnet_options&&document.body.contains(s.active_magnet_element)){const f=s.active_magnet_element.getBoundingClientRect();const v=s.active_magnet_options.force;const g=s.active_magnet_options.position;let e=f.left+f.width*g.x-o.width/2;let t=f.top+f.height*g.y-o.height/2;if(v!==1){e=e*v+(FFCursor.mouse_pos.x-o.width/2)*Math.abs(v-1);t=t*v+(FFCursor.mouse_pos.y-o.height/2)*Math.abs(v-1)}n=FFCursor.utils.lerp(a,e,.175);r=FFCursor.utils.lerp(i,t,.175)}else if(s.lerp_amount===1){n=FFCursor.mouse_pos.x-o.width/2;r=FFCursor.mouse_pos.y-o.height/2}else{n=FFCursor.utils.lerp(a,FFCursor.mouse_pos.x-o.width/2,s.lerp_amount);r=FFCursor.utils.lerp(i,FFCursor.mouse_pos.y-o.height/2,s.lerp_amount)}s.set_pos(n,r);const l=Date.now()-this.last_tick_t;const u=n-a;const c=r-i;const _={both:Math.sqrt(u*u+c*c)/l,x:u/l,y:c/l};const m=Math.abs(_.x)-Math.abs(s.velocity?s.velocity.x:0);const d=Math.abs(_.y)-Math.abs(s.velocity?s.velocity.y:0);const p={both:Math.sqrt(m*m+d*d),x:m,y:d};let h=Math.atan2(u,c);h*=180/Math.PI;h=gsap.utils.wrap(0,360,h);h=Math.abs(h-360);s.velocity=_;s.acceleration=p;if(s.on_update){s.on_update({self:this,sub_element:t,velocity:_,acceleration:p,angle:h})}})}parse_magnet_options(e){if(!e)return false;const t={...FFCursor.elements_default_options.default_magnet_options,...typeof e==="object"?e:{}};t.position=this.parse_magnet_position(t.position);return t}parse_magnet_position(e){if(typeof e!=="string"){return{x:.5,y:.5}}const t={x:["left","center","right"],y:["top","center","bottom"]};const s={x:"center",y:"center"};const o={top:0,left:0,center:.5,right:1,bottom:1};let n=e.split(" ");n={x:n[0],y:typeof n[1]!=="undefined"?n[1]:n[0]};if(t.x.includes(n.y)&&t.y.includes(n.x)){n={x:n.y,y:n.x}}if(!t.x.includes(n.x)){n.x=s.x}if(!t.y.includes(n.y)){n.y=s.y}n.x=o[n.x];n.y=o[n.y];return n}destroy(){if(this.is_disabled)return;gsap.ticker.remove(this.event_handlers.ticker);this.hover_states.forEach(e=>{document.body.removeEventListener("mouseenter",e.mouseenter_handler,{capture:true});document.body.removeEventListener("mouseleave",e.mouseleave_handler,{capture:true})});this.click_states.forEach(e=>{document.body.removeEventListener("mousedown",e.mousedown_handler,{capture:true});document.body.removeEventListener("mouseup",e.mouseup_handler,{capture:true})});this.elements.container.remove();const e=FFCursor.instances.indexOf(this);if(e>-1){FFCursor.instances.splice(e,1)}if(FFCursor.instances.length===0){document.documentElement.classList.remove("has-ffcursor","has-non-native-ffcursor")}else if(!FFCursor.instances.some(e=>!e.options.keep_native_cursor)){document.documentElement.classList.remove("has-non-native-ffcursor")}}static filter_invalid_options(t,e=FFCursor.accepted_options){return Object.fromEntries(e.filter(e=>typeof t[e]!=="undefined").map(e=>[e,t[e]]))}static get_all(){return this.instances}}(()=>{if(!FFCursor.has_pointer_device){return}FFCursor.global_event_handlers.document_mousemove=e=>{FFCursor.mouse_pos=FFCursor.utils.get_mouse_pos(e)};window.addEventListener("mousemove",FFCursor.global_event_handlers.document_mousemove);FFCursor.global_event_handlers.document_mousedown=()=>FFCursor.get_all().forEach(e=>{FFCursor.has_mouse_down=true;e.elements.container.classList.add("ffcursor--mousedown")});FFCursor.global_event_handlers.document_mouseup=()=>FFCursor.get_all().forEach(e=>{FFCursor.has_mouse_down=false;e.elements.container.classList.remove("ffcursor--mousedown")});document.addEventListener("mousedown",FFCursor.global_event_handlers.document_mousedown);document.addEventListener("mouseup",FFCursor.global_event_handlers.document_mouseup);FFCursor.global_event_handlers.document_mouseleave=()=>FFCursor.get_all().forEach(e=>{e.elements.container.classList.add("ffcursor--out-of-page")});FFCursor.global_event_handlers.document_mouseenter=()=>FFCursor.get_all().forEach(e=>{e.elements.container.classList.remove("ffcursor--out-of-page")});document.addEventListener("mouseleave",FFCursor.global_event_handlers.document_mouseleave);document.addEventListener("mouseenter",FFCursor.global_event_handlers.document_mouseenter);if(FFCursor.mouse_pos.x<0||FFCursor.mouse_pos.y<0){FFCursor.global_event_handlers.document_mouseleave()}})();